# 刚体旋转表示法的深度解析：从旋转矩阵到李群 SO(3) 及四元数算法

## 1. 引言：现代机器人学与导航中的姿态表示

在机器人学、航空航天工程、计算机视觉以及惯性导航等领域，刚体在三维空间中的姿态（Orientation）描述是一个核心且基础的数学问题。与位置（Position）不同，位置可以用欧几里得空间 $\mathbb{R}^3$ 中的向量简单表示，且具有良好的加法封闭性和交换律；而姿态的描述则涉及非欧几里得几何，其状态空间是一个弯曲的流形。这种本质上的差异导致了姿态表示的复杂性，也引出了多种数学工具：旋转矩阵（Rotation Matrix）、欧拉角（Euler Angles）、轴角（Axis-Angle）以及四元数（Quaternion）。

本报告旨在对旋转矩阵进行详尽的数学剖析，深入探讨特殊正交群 $SO(3)$ 的李群性质，并重点阐述从旋转矩阵到四元数的稳健数值转换算法。这不仅是理论推导的需求，更是工程实现的必要。在实际系统中，数值误差、计算效率以及奇异性（Singularity）问题往往决定了一个控制系统的成败。例如，在飞行器进行大机动飞行或机械臂经过奇异位型时，不恰当的姿态表示（如欧拉角）会导致“万向节死锁”（Gimbal Lock），而数值不稳定的转换算法则可能引入巨大的状态估计误差。

通过整合经典运动学理论与现代计算算法，本报告将构建一个从线性代数基础到李群微分几何，再到鲁棒数值计算的完整知识体系，为解决复杂多体动力学系统中的姿态解算问题提供坚实的理论支撑。

------

## 2. 旋转矩阵（方向余弦矩阵）的完备理论

旋转矩阵，在工程文献中常被称为方向余弦矩阵（Direction Cosine Matrix, DCM），是描述三维空间旋转最直接、最基础的代数工具。它通过线性代数中的矩阵乘法算子，建立了两个坐标系之间或同一坐标系下向量变换的严格映射关系。

### 2.1 数学定义与正交性约束

在三维欧几里得空间中，一个旋转操作可以被定义为一种保持原点不动、保持向量长度（等距变换）且保持空间手性（Handedness）的线性变换。设 $R$ 为一个 $3 \times 3$ 的实数矩阵，若 $R$ 描述了一个合法的旋转，它必须满足严格的正交性条件和行列式约束 1。

#### 2.1.1 正交性（Orthogonality）

旋转矩阵的列向量构成了旋转后坐标系在原参考坐标系中的基向量。设参考坐标系为 $\{A\}$，旋转后的坐标系为 $\{B\}$，其基向量分别为 $\hat{x}_B, \hat{y}_B, \hat{z}_B$。在 $\{A\}$ 中表示这些基向量，得到矩阵 $R$ 的三列：



$$R = \begin{bmatrix} \hat{x}_B & \hat{y}_B & \hat{z}_B \end{bmatrix}$$



由于基向量必须是单位向量且两两垂直（正交），这隐含了六个标量约束条件：

1. **模长约束**：$|\hat{x}_B| = 1, |\hat{y}_B| = 1, |\hat{z}_B| = 1$。这意味着矩阵的每一列（以及每一行）的欧几里得范数为1。
2. **正交约束**：$\hat{x}_B \cdot \hat{y}_B = 0, \hat{x}_B \cdot \hat{z}_B = 0, \hat{y}_B \cdot \hat{z}_B = 0$。

这六个约束可以紧凑地写为矩阵形式：



$$R^T R = I$$



或者等价地：



$$R^{-1} = R^T$$



这意味着旋转矩阵属于正交矩阵群 $O(3)$。这一性质极大地简化了逆运动学的计算，因为求逆运算被转置运算所替代，计算复杂度从 $O(n^3)$ 降低到了 $O(n^2)$，且数值稳定性极高 3。

#### 2.1.2 行列式与手性（Determinant and Orientation）

正交群 $O(3)$ 包含了旋转和反射（镜像）。为了排除反射操作，仅保留物理上可实现的刚体旋转，必须引入行列式约束：



$$\det(R) = +1$$



这一约束确保了坐标系的右手定则属性不被改变。如果 $\det(R) = -1$，则该矩阵表示的是一个“非真旋转”（Improper Rotation），即旋转加上一个反射操作。满足 $R^T R = I$ 且 $\det(R) = +1$ 的所有 $3 \times 3$ 实矩阵的集合，构成了特殊正交群（Special Orthogonal Group），记作 $SO(3)$ 5。

### 2.2 坐标变换与向量旋转的对偶性

在机器人运动学中，对旋转矩阵的理解常常混淆于“坐标系的变换”与“向量的旋转”之间。明确区分这两者对于推导正确的运动学方程至关重要。

被动变换（Passive Transformation）：

当我们讨论从坐标系 $\{B\}$ 到坐标系 $\{A\}$ 的变换时，物理上的点 $P$ 是不动的，改变的是描述该点的基底。设点 $P$ 在 $\{B\}$ 中的坐标为 ${}^B P$，在 $\{A\}$ 中的坐标为 ${}^A P$。此时旋转矩阵 ${}^A R_B$ 起到了基底变换的作用：



$${}^A P = {}^A R_B \, {}^B P$$



在这种语境下，${}^A R_B$ 的列向量正是 $\{B\}$ 系的坐标轴在 $\{A\}$ 系中的投影（即方向余弦）。这种表示法在连杆坐标系变换（如DH参数法）中最为常见 3。

主动变换（Active Transformation）：

另一种视角是保持坐标系不动，将一个向量 $v$ 绕原点旋转到新的位置 $v'$。此时矩阵 $R$ 充当线性算子：



$$v' = R v$$



根据惯例，如果坐标系变换是按右手定则逆时针旋转 $\theta$，那么等效的向量主动旋转矩阵在形式上是一致的。但在具体应用中，必须确认是“转动坐标系”还是“转动向量”，因为两者的矩阵互为转置（逆）关系 1。

### 2.3 旋转矩阵的特征值与欧拉旋转定理

欧拉旋转定理（Euler's Rotation Theorem）指出，刚体绕定点的任意位移都可以等效为绕通过该点的某个轴转动特定角度。这一几何事实在代数上直接反映为旋转矩阵的特征值性质。

对于任意 $R \in SO(3)$，考虑其特征方程 $R v = \lambda v$。由于旋转不改变向量长度，特征值的模长必须为1，即 $|\lambda| = 1$。由于 $R$ 是实矩阵，其特征值必然是实数或共轭复数对。

因为 $3 \times 3$ 矩阵有三个特征值，且它们的乘积等于行列式（即 $\lambda_1 \lambda_2 \lambda_3 = 1$），唯一的可能性是：

1. 一个实特征值 $\lambda_1 = 1$。
2. 一对共轭复特征值 $\lambda_2 = e^{i\theta}, \lambda_3 = e^{-i\theta}$。

**物理意义：**

- $\lambda_1 = 1$ 对应的特征向量 $v$ 满足 $R v = v$。这意味着向量 $v$ 在旋转作用下保持不变。这正是**旋转轴**（Rotation Axis）的代数定义。
- 共轭复特征值的虚部对应于在垂直于旋转轴的平面内的旋转分量，其相位角 $\theta$ 正是**旋转角度**。

通过矩阵的迹（Trace，对角元素之和）可以建立矩阵元素与旋转角 $\theta$ 的直接联系。矩阵的迹等于特征值之和：



$$\text{tr}(R) = \sum \lambda_i = 1 + e^{i\theta} + e^{-i\theta} = 1 + 2\cos\theta$$



由此可得著名的公式：



$$\theta = \arccos\left(\frac{\text{tr}(R) - 1}{2}\right)$$



这一公式揭示了旋转矩阵内部信息的压缩方式：尽管有9个元素，但核心信息仅由旋转轴（2个自由度，因单位向量约束）和旋转角（1个自由度）决定。然而，直接利用此反余弦公式在 $\theta \to 0$ 时会面临数值精度丢失的问题，这为后续引入四元数埋下了伏笔 1。

------

## 3. SO(3) 群的性质与微分几何结构

深入理解旋转矩阵，必须超越线性代数的范畴，进入李群（Lie Group）与微分几何的领域。$SO(3)$ 不仅仅是一个矩阵集合，它还是一个光滑的微分流形。这种双重结构使得我们可以对旋转进行微积分运算，这对于处理角速度、插值和优化控制至关重要。

### 3.1 群论公理在旋转中的体现

作为一个群，$SO(3)$ 满足以下公理，这些公理对应着物理世界中旋转操作的基本逻辑 5：

1. 封闭性（Closure）：任意两个旋转矩阵的乘积 $R_3 = R_1 R_2$ 仍然是一个旋转矩阵。这意味着连续两次旋转等效于一次单一的旋转。数学证明如下：

   

   $$(R_1 R_2)^T (R_1 R_2) = R_2^T R_1^T R_1 R_2 = R_2^T I R_2 = I$$

   

   且 $\det(R_1 R_2) = \det(R_1)\det(R_2) = 1 \times 1 = 1$。

2. **结合律（Associativity）**：$(R_1 R_2) R_3 = R_1 (R_2 R_3)$。这保证了在这一系列旋转中，括号的添加次序不影响最终结果。

3. **单位元（Identity）**：$3 \times 3$ 单位矩阵 $I$ 代表“零旋转”或保持姿态不变。

4. **逆元（Inverse）**：对任意旋转 $R$，存在逆变换 $R^{-1} = R^T$，代表“反向旋转”，使得物体回到初始姿态。

值得注意的是，$SO(3)$ 是**非阿贝尔群**（Non-Abelian Group），即不满足交换律：$R_1 R_2 \neq R_2 R_1$。这一性质对应了物理事实：先绕X轴转再绕Y轴转，与先绕Y轴转再绕X轴转，结果截然不同。这与位置向量的加法群（$\mathbb{R}^3$）形成了鲜明对比。

### 3.2 SO(3) 的流形结构与拓扑

在拓扑学上，$SO(3)$ 是一个紧致（Compact）、连通（Connected）的三维流形。我们可以将其想象为嵌入在 $\mathbb{R}^9$ 空间中的一个光滑曲面。然而，它的全局形状极其特殊，同胚于**实射影空间** $\mathbb{R}P^3$ 8。

一种直观的可视化方法是将其视为一个半径为 $\pi$ 的实心球体。球体内的每一个点，其方向代表旋转轴，其与圆心的距离代表旋转角 $\theta$。

- 原点代表单位阵（零旋转）。
- 球体内部的点代表 $\theta < \pi$ 的旋转。
- **关键的拓扑特性**出现在球体的表面（边界），即 $\theta = \pi$ 的旋转。绕轴 $u$ 旋转 $\pi$ 与绕轴 $-u$ 旋转 $\pi$ 实际上产生相同的物理姿态。因此，这个实心球体表面的对径点（Antipodal points）必须被“粘合”或视为同一个点。

这种对径点的粘合导致 $SO(3)$ **不是单连通**（Not Simply Connected）的。其基本群（Fundamental Group）为 $\pi_1(SO(3)) \cong \mathbb{Z}_2$。这意味着在旋转群中存在两类闭合路径：

1. 一类可以连续收缩到一个点（例如，小幅度的往复晃动）。
2. 另一类无法收缩到一个点（例如，旋转 $360^\circ$ 回到原点）。这就解释了为什么在量子力学和某些机器人控制问题中，旋转 $360^\circ$ 与旋转 $720^\circ$ 有着拓扑上的本质区别。旋转 $720^\circ$ 的路径属于第一类（可收缩），而 $360^\circ$ 不行。这正是引入四元数作为 $SO(3)$ “双重覆盖”的拓扑学动因 10。

### 3.3 李代数 $\mathfrak{so}(3)$ 与切空间

在处理连续变化的旋转（如机器人关节运动）时，我们需要研究 $SO(3)$ 上的微分方程。李群理论告诉我们，研究李群单位元处的切空间（Tangent Space）可以揭示群的局部性质。$SO(3)$ 对应的李代数记为 $\mathfrak{so}(3)$ 7。

#### 3.3.1 反对称矩阵的导出

考虑一条经过单位元的轨迹 $R(t)$，满足 $R(0) = I$。对正交约束 $R(t) R(t)^T = I$ 两边对时间 $t$ 求导：



$$\dot{R}(t) R(t)^T + R(t) \dot{R}(t)^T = 0$$



在 $t=0$ 时，由于 $R(0)=I$，方程变为：



$$\dot{R}(0) + \dot{R}(0)^T = 0 \implies \dot{R}(0)^T = -\dot{R}(0)$$



这表明，单位元处的切向量 $\dot{R}(0)$ 必须是一个反对称矩阵（Skew-symmetric Matrix）。

#### 3.3.2 物理意义：角速度张量

三维空间中的反对称矩阵只有3个独立元素。对于任意向量 $\omega = [\omega_x, \omega_y, \omega_z]^T \in \mathbb{R}^3$，可以定义一个唯一的反对称矩阵 $[\omega]_\times$（有时记为 $\hat{\omega}$）：



$$[\omega]_\times = \begin{bmatrix} 0 & -\omega_z & \omega_y \\ \omega_z & 0 & -\omega_x \\ -\omega_y & \omega_x & 0 \end{bmatrix}$$



这个矩阵的作用等价于向量叉乘，即 $[\omega]_\times v = \omega \times v$。在运动学中，$\omega$ 正是物理上的角速度向量。李代数 $\mathfrak{so}(3)$ 实际上就是角速度向量的空间。这建立了一个重要的桥梁：虽然旋转本身（$SO(3)$）是弯曲的、非线性的，但其瞬时变化率（角速度 $\mathfrak{so}(3)$）却构成了一个线性的向量空间。

### 3.4 指数映射（Exponential Map）

指数映射 $\exp: \mathfrak{so}(3) \to SO(3)$ 是连接李代数与李群的纽带。它描述了如何通过积分恒定的角速度来获得有限的旋转。

从矩阵指数的泰勒级数定义出发：



$$R = \exp([\omega]_\times) = \sum_{k=0}^{\infty} \frac{([\omega]_\times)^k}{k!}$$



利用反对称矩阵的性质 $[\omega]_\times^3 = -\|\omega\|^2 [\omega]_\times$，可以将无穷级数收敛为闭形式的罗德里格斯公式（Rodrigues' Rotation Formula）：

令 $\theta = \|\omega\|$，单位轴 $u = \omega / \theta$，则：



$$R = I + \sin\theta [u]_\times + (1 - \cos\theta) [u]_\times^2$$



这个公式在机器人学中被极为广泛地用于从轴角表示恢复旋转矩阵。其逆映射（对数映射）则用于从矩阵提取角速度或误差向量 12。

------

## 4. 四元数：旋转的代数与几何优势

虽然旋转矩阵理论完备，但在计算上存在冗余（9个参数表示3个自由度）且在插值时极其困难。四元数（Quaternion），特别是单位四元数，提供了一种更紧凑、数值更稳定且拓扑性质更优的表示方法。

### 4.1 四元数的代数定义

四元数 $\mathbb{H}$ 是复数系的非交换扩张，由哈密顿（Hamilton）提出。一个四元数 $q$ 由一个实部（标量）$q_w$ 和三个虚部（矢量）$q_v = (q_x, q_y, q_z)$ 组成：



$$q = q_w + q_x i + q_y j + q_z k$$



基本虚数单位满足 $i^2 = j^2 = k^2 = ijk = -1$。在机器人学中，通常采用向量形式书写 $q = [q_w, q_x, q_y, q_z]^T$（注意：部分文献如JPL习惯将标量放在最后，需特别注意区分）14。

### 4.2 单位四元数与双重覆盖（Double Cover）

为了表示旋转，我们限制四元数为单位四元数，即 $\|q\| = \sqrt{q_w^2 + q_x^2 + q_y^2 + q_z^2} = 1$。所有单位四元数构成的集合是四维空间中的单位超球面 $S^3$。

旋转轴 $u$ 和旋转角 $\theta$ 与单位四元数的对应关系为：



$$q = \left[ \cos\frac{\theta}{2}, \quad u_x \sin\frac{\theta}{2}, \quad u_y \sin\frac{\theta}{2}, \quad u_z \sin\frac{\theta}{2} \right]$$



这里出现的 $\theta/2$ 是四元数性质的核心。

双重覆盖特性：

注意到如果我们用 $\theta + 2\pi$ 代替 $\theta$，物理上的旋转姿态应当不变（旋转 $360^\circ$）。然而，代入四元数公式：



$$\cos\frac{\theta+2\pi}{2} = \cos(\frac{\theta}{2} + \pi) = -\cos\frac{\theta}{2}$$

$$\sin\frac{\theta+2\pi}{2} = -\sin\frac{\theta}{2}$$



这导致原来的 $q$ 变成了 $-q$。这表明，$q$ 和 $-q$ 对应着同一个旋转矩阵 $R$。换句话说，单位四元数群 $S^3$ 是旋转群 $SO(3)$ 的双重覆盖（Double Cover），存在一个 2 对 1 的同态映射 $S^3 \to SO(3)$ 15。

这种性质不仅不是缺陷，反而是其最大的优势。由于 $S^3$ 是单连通的（Simply Connected），它消除了 $SO(3)$ 中的拓扑复杂性。在进行姿态插值（如Slerp算法）或控制律设计时，这种连续性避免了欧拉角那样的跳变或奇异性。只要在算法中确保选择与当前姿态“距离最近”的那个四元数（即点积符号为正），就可以实现极其平滑的运动控制。

------

## 5. 核心算法：从旋转矩阵到四元数的稳健过渡

在实际工程中，我们经常需要将传感器（如视觉里程计、陀螺仪积分）输出的旋转矩阵转换为四元数以进行后续的滤波或控制。尽管理论上两者等价，但在数字计算机上实现这一转换却面临严峻的数值稳定性挑战。本节将详细阐述这一过程中的“坑”以及工业界标准的解决方案。

### 5.1 朴素算法的数值陷阱：“迹”法（Trace Method）

最直观的转换利用了矩阵的迹（Trace）。根据罗德里格斯公式的四元数形式，旋转矩阵 $R$ 的对角元素之和为：



$$\text{tr}(R) = r_{11} + r_{22} + r_{33} = 3 - 4(q_x^2 + q_y^2 + q_z^2)$$



利用归一化条件 $q_x^2 + q_y^2 + q_z^2 = 1 - q_w^2$，可得：



$$\text{tr}(R) = 4q_w^2 - 1 \implies q_w = \frac{1}{2}\sqrt{\text{tr}(R) + 1}$$



一旦求出 $q_w$，利用矩阵反对称部分的元素即可求出其余分量：



$$q_x = \frac{r_{32} - r_{23}}{4q_w}, \quad q_y = \frac{r_{13} - r_{31}}{4q_w}, \quad q_z = \frac{r_{21} - r_{12}}{4q_w}$$

致命缺陷：

当旋转角度接近 $180^\circ$（$\pi$）时，$\cos(\theta/2) \to 0$，即 $q_w \to 0$。

1. **除零奇点**：上述公式中 $q_w$ 作分母。当 $q_w$ 极小时，浮点数除法会极度放大矩阵元素中的噪声，甚至触发除零错误。

2. 根号内负值：如果矩阵存在噪声使得 $\text{tr}(R) < -1$，根号运算将无定义。

   因此，简单的“迹”法在处理大角度旋转时是不可用的 17。

### 5.2 工业标准：Shepperd (Stanley) 算法

为了解决除零问题，Shepperd (1978) 提出了一种基于“投票”或“分支”策略的算法（有时也被归功于 Stanley 或 Klumpp）。该算法的核心思想是：**总是选择四元数四个分量中绝对值最大的那个作为分母**，从而保证数值稳定性。

根据旋转矩阵的代数结构，我们有四个等价的平方关系：

1. $4q_w^2 = 1 + r_{11} + r_{22} + r_{33}$
2. $4q_x^2 = 1 + r_{11} - r_{22} - r_{33}$
3. $4q_y^2 = 1 - r_{11} + r_{22} - r_{33}$
4. $4q_z^2 = 1 - r_{11} - r_{22} + r_{33}$

算法流程：

第一步，计算矩阵的迹 $T = \text{tr}(R)$。

第二步，比较 $T$ 与对角线元素的大小，选择最大的项进行计算。由于单位四元数满足 $q_w^2 + q_x^2 + q_y^2 + q_z^2 = 1$，必有一个分量的平方大于等于 $0.25$，即绝对值大于等于 $0.5$。这保证了除数永远远离零。

- Case 1: $T > 0$（即旋转角较小，主导项为 $q_w$）：

  使用朴素迹法：

  

  $$q_w = 0.5 \sqrt{1 + T}$$

  $$q_x = (r_{32} - r_{23}) / (4q_w)$$

  $$q_y = (r_{13} - r_{31}) / (4q_w)$$

  $$q_z = (r_{21} - r_{12}) / (4q_w)$$

- Case 2: $r_{11}$ 最大（即旋转轴接近X轴，主导项为 $q_x$）：

  

  $$q_x = 0.5 \sqrt{1 + r_{11} - r_{22} - r_{33}}$$

  $$q_w = (r_{32} - r_{23}) / (4q_x)$$

  $$q_y = (r_{12} + r_{21}) / (4q_x)$$

  $$q_z = (r_{31} + r_{13}) / (4q_x)$$

- Case 3: $r_{22}$ 最大（即旋转轴接近Y轴，主导项为 $q_y$）：

  

  $$q_y = 0.5 \sqrt{1 - r_{11} + r_{22} - r_{33}}$$

  $$q_w = (r_{13} - r_{31}) / (4q_y)$$

  $$q_x = (r_{12} + r_{21}) / (4q_y)$$

  $$q_z = (r_{23} + r_{32}) / (4q_y)$$

- Case 4: $r_{33}$ 最大（即旋转轴接近Z轴，主导项为 $q_z$）：

  

  $$q_z = 0.5 \sqrt{1 - r_{11} - r_{22} + r_{33}}$$

  $$q_w = (r_{21} - r_{12}) / (4q_z)$$

  $$q_x = (r_{31} + r_{13}) / (4q_z)$$

  $$q_y = (r_{23} + r_{32}) / (4q_z)$$

这种分支逻辑被广泛应用于Eigen、ROS (tf2) 以及各类飞行控制软件中，是处理旋转矩阵到四元数转换的最鲁棒方法 6。

### 5.3 噪声处理：Bar-Itzhack 最优提取法

在某些极端情况下，输入的旋转矩阵 $R$ 可能由于传感器噪声或积分漂移而不再满足严格的正交性（即 $R^T R \neq I$）。此时，Shepperd 算法虽然能算出一个四元数，但该四元数对应的旋转矩阵可能并不是原噪声矩阵的最佳近似。

Bar-Itzhack (2000) 提出了一种基于优化的方法。该方法不直接代数求解，而是构建一个 $4 \times 4$ 的对称矩阵 $K$（源自 Wahba 问题的 QUEST 算法）：

$$K = \frac{1}{3} \begin{bmatrix} r_{11}-r_{22}-r_{33} & r_{21}+r_{12} & r_{31}+r_{13} & r_{23}-r_{32} \\ r_{21}+r_{12} & r_{22}-r_{11}-r_{33} & r_{32}+r_{23} & r_{31}-r_{13} \\ r_{31}+r_{13} & r_{32}+r_{23} & r_{33}-r_{11}-r_{22} & r_{12}-r_{21} \\ r_{23}-r_{32} & r_{31}-r_{13} & r_{12}-r_{21} & r_{11}+r_{22}+r_{33} \end{bmatrix}$$

数学推导证明，该矩阵 $K$ 的**最大特征值所对应的特征向量**，即为在 Frobenius 范数意义下最接近原矩阵 $R$ 的最优单位四元数。

这种方法虽然计算量较大（涉及特征值分解），但在处理带有显著测量噪声的数据时（如卫星姿态确定），它提供了统计意义上的最优解，且天然对非正交矩阵具有鲁棒性 19。

------

## 6. 总结与展望

旋转矩阵、$SO(3)$ 群和四元数构成了描述刚体姿态的三位一体。

1. **旋转矩阵 ($SO(3)$)** 是物理直观的基石，提供了坐标变换的直接线性算子，但其参数冗余和正交性约束使其不适合作为状态变量进行积分或优化。
2. **李群与李代数 ($\mathfrak{so}(3)$)** 揭示了旋转空间的微分结构，建立了角速度（切空间）与姿态（流形）之间的指数映射桥梁，是现代机器人控制和视觉SLAM算法（如流形优化）的理论核心。
3. **四元数 ($S^3$)** 作为 $SO(3)$ 的双重覆盖，以其紧凑性、无奇异性和计算高效性（归一化方便、插值平滑），成为了飞行器和游戏引擎中姿态表示的事实标准。

对于工程师而言，理解这一体系不仅意味着能推导公式，更意味着能根据应用场景选择正确的工具：在需要直观理解基向量时使用矩阵；在进行卡尔曼滤波或动力学积分时使用四元数；在进行转换时，务必采用 Shepperd 算法等鲁棒数值方案，以确保系统在 $180^\circ$ 等奇异点附近的安全性。

------

**主要参考文献：**

- 3 机器人学导论 (用户上传资料)
- 1 Rotation Matrix Properties & Definitions
- 5 SO(3) Group Theory, Lie Algebra & Manifolds
- 6 Shepperd's Algorithm & Robust Conversion
- 19 Bar-Itzhack's Optimal Extraction
- 10 Double Cover & Topology of Quaternions
